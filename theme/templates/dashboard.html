{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    <!-- Total Contracts -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-700">Total Contracts</h3>
        <p class="text-3xl font-bold text-gray-900">{{ total_contracts }}</p>
    </div>

    <!-- Contracts by Status -->
    {% for status, count in status_data.items %}
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-700">{{ status|title }}</h3>
        <p class="text-3xl font-bold text-gray-900">{{ count }}</p>
    </div>
    {% endfor %}
</div>

<div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Upcoming Milestones -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-700 mb-4">Upcoming Milestones (Next 30 Days)</h3>
        {% if upcoming_milestones %}
            <ul>
                {% for contract in upcoming_milestones %}
                    <li class="border-b py-2">
                        <a href="#" class="text-blue-600 hover:underline">{{ contract.title }}</a>
                        <span class="text-gray-600 ml-2">{{ contract.milestone_date }}</span>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-gray-600">No upcoming milestones.</p>
        {% endif %}
    </div>

    <!-- Recent Notes -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-700 mb-4">Recent Notes</h3>
        {% if recent_notes %}
            <ul>
                {% for note in recent_notes %}
                    <li class="border-b py-2">
                        <p class="text-gray-800">{{ note.text|truncatewords:10 }}</p>
                        <p class="text-sm text-gray-500">
                            By {{ note.created_by.username }} on
                            <a href="#" class="text-blue-600 hover:underline">{{ note.contract.title }}</a>
                        </p>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-gray-600">No recent notes.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
